<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>✤ SPC Tools ✤</title>

  <!-- ====== FAVICON SETUP ====== -->
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="180x180" href="favicon-180.png">
  <meta name="theme-color" content="#1e3a5f">

  <!-- ====== ICONS ====== -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    * { box-sizing: border-box; scrollbar-width: none; }
    *::-webkit-scrollbar { display: none; }

    html, body {
      margin: 0;
      height: 100%;
      font-family: "Segoe UI", "Inter", sans-serif;
      background: linear-gradient(135deg, #eaf1ff, #f9fcff);
      color: #1e293b;
      overflow: hidden;
    }

    .container { display: flex; height: 100vh; width: 100%; }

    /* SIDEBAR */
    .sidebar {
      width: 250px;
      background: linear-gradient(180deg,#1e3a5f,#122946);
      color: #fff;
      display: flex;
      flex-direction: column;
      padding: 1.2rem;
      box-shadow: 5px 0 20px rgba(0,0,0,0.15);
      position: relative;
      z-index: 5;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
      justify-content: center;
      margin-bottom: 1.5rem;
    }
    .logo img {
      width: 40px; height: 40px;
      border-radius: 8px;
      box-shadow: 0 0 8px rgba(253,216,53,0.7);
    }
    .logo span {
      font-size: 1.2rem;
      font-weight: 600;
      letter-spacing: 0.3px;
    }

    nav {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    nav a {
      text-decoration: none;
      color: #fff;
      background: rgba(255,255,255,0.08);
      padding: 10px 12px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: 0.15s;
    }
    nav a:hover { background: rgba(255,255,255,0.15); }
    nav a.active { background: #2e5c8f; }

    .footer {
      font-size: 12px; color: #cbd5e1; text-align: center;
    }

    /* MAIN AREA */
    .main {
      flex: 1; display: flex; flex-direction: column;
      position: relative; overflow: hidden;
    }
    header {
      background: #fff;
      padding: 0.9rem 1rem;
      border-bottom: 1px solid #e5e7eb;
      display: flex; align-items: center; justify-content: space-between;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }
    header h1 { font-size: 1.05rem; color: #1e3a5f; margin: 0; font-weight: 600; }
    header button {
      border: none; background: #1e3a5f; color: #fff;
      padding: 6px 12px; border-radius: 6px;
      cursor: pointer; transition: 0.2s;
    }
    header button:hover { background: #2d5b8a; }

    .frame-wrap { flex: 1; position: relative; overflow: hidden; }

    iframe {
      width: 100%;
      height: 100%;
      border: none;
      opacity: 1 !important;
      transform: none !important;
      transition: none !important;
      background: #fff;
    }

    @media(max-width:800px){
      .sidebar { width: 220px; }
      .logo span { font-size: 1rem; }
    }
  </style>
</head>
<body>

  <div class="container">

    <!-- SIDEBAR -->
    <aside class="sidebar">
      <div class="logo">
        <img src="favicon-64.png" alt="SPC Logo">
        <span>SPC Tools</span>
      </div>

      <nav>
        <a href="#/booklet" data-file="HITUNG BOOKLET.html" class="active">
          <i class="fa-solid fa-book-open"></i> Hitung Booklet
        </a>
        <a href="#/softcover" data-file="HITUNG SOFTCOVER.html">
          <i class="fa-solid fa-book"></i> Hitung Softcover
        </a>
        <a href="#/objek" data-file="HITUNG OBJEK.html">
          <i class="fa-solid fa-th"></i> Hitung Objek
        </a>
        <a href="#/bw" data-file="PISAH WARNA BW.html">
          <i class="fa-solid fa-fill-drip"></i> Pisah Warna BW
        </a>
        <a href="#/img2pdf" data-file="IMG TO PDF.html">
          <i class="fa-solid fa-image"></i> IMG to PDF
        </a>
        <a href="#/pdf2img" data-file="PDF TO IMG.html">
          <i class="fa-solid fa-file-pdf"></i> PDF to IMG
        </a>
        <a href="#/proporsional" data-file="HITUNG PROPORSIONAL.html">
          <i class="fa-solid fa-expand"></i> Hitung Proporsional
        </a>
        <a href="#/spiral" data-file="HITUNG UKURAN SPIRAL.html">
          <i class="fa-solid fa-ruler-combined"></i> Ukuran Spiral
        </a>

        <!-- ✅ TAB BARU: MACRO COREL -->
        <a href="#/macrocorel" data-file="MACRO COREL.html">
          <i class="fa-solid fa-wand-magic-sparkles"></i> Macro Corel
        </a>
      </nav>

      <div class="footer">© 2025 Spectrum Digital Printing</div>
    </aside>

    <!-- MAIN -->
    <div class="main">
      <header>
        <h1 id="pageTitle">SPC Tools — Utility Panel</h1>
        <button onclick="reloadTool()">
          <i class="fa-solid fa-rotate-right"></i> Refresh
        </button>
      </header>

      <div class="frame-wrap">
        <iframe id="toolFrame"></iframe>
      </div>
    </div>

  </div>

  <script>
    const frame = document.getElementById("toolFrame");
    const links = document.querySelectorAll("nav a");
    const title = document.getElementById("pageTitle");

    function loadTool(el, file) {
      links.forEach(a => a.classList.remove("active"));
      el.classList.add("active");

      frame.src = file;
      title.textContent = "SPC Tools — " + el.textContent.trim();

      localStorage.setItem("spc:last", file);
    }

    function reloadTool() {
      if (frame && frame.contentWindow) frame.contentWindow.location.reload();
    }

    function openFromHash() {
      const hash = location.hash.replace("#/", "");
      let found = false;

      links.forEach(a => {
        if (a.getAttribute("href") === "#/" + hash) {
          loadTool(a, a.dataset.file);
          found = true;
        }
      });

      if (!found) {
        const last = localStorage.getItem("spc:last");
        frame.src = last || links[0].dataset.file;
      }
    }

    links.forEach(a => {
      a.addEventListener("click", e => {
        e.preventDefault();
        loadTool(a, a.dataset.file);
        history.replaceState(null, "", a.getAttribute("href"));
      });
    });

    openFromHash();
  </script>
</body>
</html>
